
# 1. signin as root

enable **mfa for the root user**:

``iam → users → root user → security credentials → mfa``

root is now secured and ready to bootstrap identity center.

---

# 2. enable aws identity center
navigate to:

``aws console → iam identity center``

click:

``enable``

choose **aws identity center directory (default)** unless you want external identity providers.

identity center will create:
- the identity directory
- the “aws reserved” application
- permission sets capability

---

# 3. create an admin permission set
identity center → **permission sets** → create permission set

\`\`\`
name: AdministratorAccess
type: predefined
policy: AdministratorAccess
session duration: 1 hour (or 4 hours if preferred)
require mfa: yes
\`\`\`

this permission set will define the admin role that users assume.

---

# 4. create your admin user in identity center
identity center → **users** → create user

\`\`\`
email: you@yourdomain.com
username: you
name: your name
\`\`\`

invite the user. you will receive a sign-in email.

---

# 5. assign the admin user to the account
identity center → **aws accounts** →  assign users or groups

select:

\`\`\`
target account: <your aws account>
permission set: AdministratorAccess
user: you
\`\`\`

click **assign**.

---

# 6. install & configure aws cli for sso
on your local machine:

\`\`\`
aws configure sso
\`\`\`

you will be prompted for:
1. sso session name
   1. e.g., `ehmpathy.root.admin`
2. sso start url
   1. e.g., https://d-xxxxxxxx.awsapps.com/start
   2. see identity center home page; listed as aws access portal url
3. sso region
   1. e.g., us-east-1
4. sso registration scopes
   1. default is fine; just press enter
5. confirm the login prompt
6. press enter when it asks for default client region
   1. us-east-1 = default, thats fine
7. press enter when it asks for cli default output format
   1. uses json as default, thats best
8. set your profile name
   1. e.g., ehmpathy.root.admin

then, you're ready to use it

e.g.,

aws sts get-caller-identity --profile ehmpathy.root.admin

---

# 7. sign in with identity center
you can now authenticate without root credentials:

e.g.,
\`\`\`
aws sso login --profile ehmpathy.root.admin
\`\`\`

verify:

\`\`\`
aws sts get-caller-identity
\`\`\`

you should see the `AWSReservedSSO_AdministratorAccess` role.

---

# 8. add a bash alias for convenience
run this to add the function to `~/.bash_aliases` and reload:

```bash
findsert_alias() {
  local func_def='use_ehmpathy_root_admin() { export AWS_PROFILE=ehmpathy.root.admin; aws sts get-caller-identity &>/dev/null || aws sso login; }'
  local alias_def='alias use.ehmpathy.root.admin=use_ehmpathy_root_admin'
  grep -qxF "$func_def" ~/.bash_aliases || echo "$func_def" >> ~/.bash_aliases
  grep -qxF "$alias_def" ~/.bash_aliases || echo "$alias_def" >> ~/.bash_aliases
  source ~/.bash_aliases
}
findsert_alias
```

now you can quickly switch profiles (auto-logs in if expired):

```bash
use.ehmpathy.root.admin
aws sts get-caller-identity  # uses ehmpathy.root.admin profile
```
