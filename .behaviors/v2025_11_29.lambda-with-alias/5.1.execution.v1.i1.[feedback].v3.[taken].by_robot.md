# feedback.v3.response

## blocker.1: AwsSdk*Raw => SdkAws*
- [x] rename `AwsSdkPolicyStatementRaw` => `SdkAwsPolicyStatementRaw`
- [x] rename `AwsSdkPolicyDocumentRaw` => `SdkAwsPolicyDocumentRaw`
- [x] rename `AwsSdkPolicyPrincipal` => `SdkAwsPolicyPrincipal`
- [x] rename `AwsSdkPolicyStatement` => `SdkAwsPolicyStatement`

## blocker.2: reuse aws sdk types directly
- [x] investigated aws sdk types - PolicyDocument and AssumeRolePolicyDocument are returned as URL-encoded JSON strings, not typed objects
- [x] confirmed we need custom types for parsed policy document structure since SDK doesn't export them

## blocker.3: forbid unknown in castIntoDeclaredAwsIamPrincipal
- [x] identified single caller: `castIntoDeclaredAwsIamPolicyStatement`
- [x] replaced `unknown` with `SdkAwsPolicyPrincipal | undefined`
- [x] updated `SdkAwsPolicyStatementRaw.Principal` from `unknown` to `SdkAwsPolicyPrincipal`

## blocker.4: qualify type source with SdkAws prefix
- [x] changed `Role` => `SdkAwsRole` via type alias in `castIntoDeclaredAwsIamRole.ts`
- [x] updated test file to use same alias

## blocker.5: eliminate `as RefByUnique` casts from prodcode
- [x] removed cast in `castIntoDeclaredAwsIamRolePolicy.ts` - types fit naturally
- [x] removed cast in `setIamRolePolicy.ts` - `policyDesired.role` already typed correctly
- [x] removed cast in `getIamRolePolicy.ts` - `input.by.unique.role` already typed correctly

## blocker.6: setLambda missing attributes
- [x] added `tags?: Record<string, string>` field to `DeclaredAwsLambda`
- [x] updated `setLambda` to spread user tags: `Tags: { ...lambdaDesired.tags, codeZipUri: ... }`
- [x] switched `getOneLambda` from `GetFunctionConfigurationCommand` to `GetFunctionCommand` to get tags
- [x] updated `castIntoDeclaredAwsLambda` to:
  - accept `tags` in input
  - extract `codeZipUri` from tags (system-managed)
  - pass remaining tags to domain object
- [x] updated test files for new response structure

## verification
- [x] `npm run test:types` passes
- [x] all 219 unit tests pass
