# execution: phase 2 - domain objects

## status: complete âœ…

## summary

created domain objects and provider type for aws vpc tunnel infrastructure:

- `DeclaredAwsEc2Instance` - ec2 instance domain entity
- `DeclaredAwsRdsCluster` - rds cluster domain entity
- `DeclaredAwsVpcTunnel` - vpc tunnel composite domain entity
- `DeclastructAwsProvider` - provider type definition

## files created

### domain objects

1. `src/domain.objects/DeclaredAwsEc2Instance.ts`
   - properties: `id?`, `exid`, `status?`, `privateIp?`
   - static keys: `primary = ['id']`, `unique = ['exid']`

2. `src/domain.objects/DeclaredAwsRdsCluster.ts`
   - properties: `name`, `arn?`, `host?`, `port?`, `status?`
   - static keys: `unique = ['name']`, `metadata = ['arn']`

3. `src/domain.objects/DeclaredAwsVpcTunnel.ts`
   - properties: `via`, `into`, `from`, `status?`, `pid?`
   - static keys: `unique = ['via', 'into', 'from']`
   - uses `RefByUnique` for bastion and cluster references

4. `src/domain.objects/DeclastructAwsProvider.ts`
   - defines `DeclastructAwsDaos` interface
   - defines `DeclastructAwsProvider` type

### unit tests

1. `src/domain.objects/DeclaredAwsEc2Instance.test.ts` - 6 tests
2. `src/domain.objects/DeclaredAwsRdsCluster.test.ts` - 6 tests
3. `src/domain.objects/DeclaredAwsVpcTunnel.test.ts` - 5 tests

## verification

```
npm run test:types  # passes
npm run test:unit   # 17 tests pass
```

## notes

- `DeclaredAwsRdsCluster` does not have a `primary` key since `arn` is metadata (only known after aws lookup)
- `DeclaredAwsEc2Instance` has `primary = ['id']` since instance id is the aws-assigned identifier
- `DeclaredAwsVpcTunnel` uses composite unique key of `['via', 'into', 'from']` to identify tunnels
- provider type uses `Omit` + intersection pattern to work around typescript variance issues with `DeclastructDaosShape`
